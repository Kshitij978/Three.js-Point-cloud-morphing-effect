var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{L as s,F as i,C as n,G as r,B as o,a,b as c,M as l,P as h,c as u,d,e as m,f as p,V as f,T as g,g as b,S as y,h as v,W as w,i as A,A as x}from"./three-r3By-ZkY.js";import{g as j}from"./gsap-DdPmJgzX.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const E=/^[og]\s*(.+)?/,S=/^mtllib /,I=/^usemtl /,V=/^usemap /,F=/\s+/,L=new f,B=new f,C=new f,z=new f,M=new f,P=new n;function T(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);const s=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){const s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1);const i={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==s?s.smooth:this.smooth,groupStart:void 0!==s?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){const e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(i),i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(let s=this.materials.length-1;s>=0;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},s&&s.name&&"function"==typeof s.clone){const t=s.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const s=parseInt(t,10);return 3*(s>=0?s-1:s+e/3)},parseNormalIndex:function(t,e){const s=parseInt(t,10);return 3*(s>=0?s-1:s+e/3)},parseUVIndex:function(t,e){const s=parseInt(t,10);return 2*(s>=0?s-1:s+e/2)},addVertex:function(t,e,s){const i=this.vertices,n=this.object.geometry.vertices;n.push(i[t+0],i[t+1],i[t+2]),n.push(i[e+0],i[e+1],i[e+2]),n.push(i[s+0],i[s+1],i[s+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,s){const i=this.normals,n=this.object.geometry.normals;n.push(i[t+0],i[t+1],i[t+2]),n.push(i[e+0],i[e+1],i[e+2]),n.push(i[s+0],i[s+1],i[s+2])},addFaceNormal:function(t,e,s){const i=this.vertices,n=this.object.geometry.normals;L.fromArray(i,t),B.fromArray(i,e),C.fromArray(i,s),M.subVectors(C,B),z.subVectors(L,B),M.cross(z),M.normalize(),n.push(M.x,M.y,M.z),n.push(M.x,M.y,M.z),n.push(M.x,M.y,M.z)},addColor:function(t,e,s){const i=this.colors,n=this.object.geometry.colors;void 0!==i[t]&&n.push(i[t+0],i[t+1],i[t+2]),void 0!==i[e]&&n.push(i[e+0],i[e+1],i[e+2]),void 0!==i[s]&&n.push(i[s+0],i[s+1],i[s+2])},addUV:function(t,e,s){const i=this.uvs,n=this.object.geometry.uvs;n.push(i[t+0],i[t+1]),n.push(i[e+0],i[e+1]),n.push(i[s+0],i[s+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,s,i,n,r,o,a,c){const l=this.vertices.length;let h=this.parseVertexIndex(t,l),u=this.parseVertexIndex(e,l),d=this.parseVertexIndex(s,l);if(this.addVertex(h,u,d),this.addColor(h,u,d),void 0!==o&&""!==o){const t=this.normals.length;h=this.parseNormalIndex(o,t),u=this.parseNormalIndex(a,t),d=this.parseNormalIndex(c,t),this.addNormal(h,u,d)}else this.addFaceNormal(h,u,d);if(void 0!==i&&""!==i){const t=this.uvs.length;h=this.parseUVIndex(i,t),u=this.parseUVIndex(n,t),d=this.parseUVIndex(r,t),this.addUV(h,u,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let s=0,i=t.length;s<i;s++){const i=this.parseVertexIndex(t[s],e);this.addVertexPoint(i),this.addColor(i)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const s=this.vertices.length,i=this.uvs.length;for(let n=0,r=t.length;n<r;n++)this.addVertexLine(this.parseVertexIndex(t[n],s));for(let n=0,r=e.length;n<r;n++)this.addUVLine(this.parseUVIndex(e[n],i))}};return t.startObject("",!1),t}class U extends s{constructor(t){super(t),this.materials=null}load(t,e,s,n){const r=this,o=new i(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(s){try{e(r.parse(s))}catch(i){n&&n(i),r.manager.itemError(t)}},s,n)}setMaterials(t){return this.materials=t,this}parse(t){const e=new T;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));const s=t.split("\n");let i=[];for(let r=0,o=s.length;r<o;r++){const t=s[r].trimStart();if(0===t.length)continue;const n=t.charAt(0);if("#"!==n)if("v"===n){const s=t.split(F);switch(s[0]){case"v":e.vertices.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3])),s.length>=7?(P.setRGB(parseFloat(s[4]),parseFloat(s[5]),parseFloat(s[6])).convertSRGBToLinear(),e.colors.push(P.r,P.g,P.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));break;case"vt":e.uvs.push(parseFloat(s[1]),parseFloat(s[2]))}}else if("f"===n){const s=t.slice(1).trim().split(F),i=[];for(let t=0,e=s.length;t<e;t++){const e=s[t];if(e.length>0){const t=e.split("/");i.push(t)}}const n=i[0];for(let t=1,r=i.length-1;t<r;t++){const s=i[t],r=i[t+1];e.addFace(n[0],s[0],r[0],n[1],s[1],r[1],n[2],s[2],r[2])}}else if("l"===n){const s=t.substring(1).trim().split(" ");let i=[];const n=[];if(-1===t.indexOf("/"))i=s;else for(let t=0,e=s.length;t<e;t++){const e=s[t].split("/");""!==e[0]&&i.push(e[0]),""!==e[1]&&n.push(e[1])}e.addLineGeometry(i,n)}else if("p"===n){const s=t.slice(1).trim().split(" ");e.addPointGeometry(s)}else if(null!==(i=E.exec(t))){const t=(" "+i[0].slice(1).trim()).slice(1);e.startObject(t)}else if(I.test(t))e.object.startMaterial(t.substring(7).trim(),e.materialLibraries);else if(S.test(t))e.materialLibraries.push(t.substring(7).trim());else if(V.test(t));else if("s"===n){if(i=t.split(" "),i.length>1){const t=i[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const s=e.object.currentMaterial();s&&(s.smooth=e.object.smooth)}else if("\0"===t)continue}e.finalize();const n=new r;n.materialLibraries=[].concat(e.materialLibraries);if(!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(let r=0,f=e.objects.length;r<f;r++){const t=e.objects[r],s=t.geometry,i=t.materials,f="Line"===s.type,g="Points"===s.type;let b=!1;if(0===s.vertices.length)continue;const y=new o;y.setAttribute("position",new a(s.vertices,3)),s.normals.length>0&&y.setAttribute("normal",new a(s.normals,3)),s.colors.length>0&&(b=!0,y.setAttribute("color",new a(s.colors,3))),!0===s.hasUVIndices&&y.setAttribute("uv",new a(s.uvs,2));const v=[];for(let n=0,r=i.length;n<r;n++){const t=i[n],s=t.name+"_"+t.smooth+"_"+b;let r=e.materials[s];if(null!==this.materials)if(r=this.materials.create(t.name),!f||!r||r instanceof c){if(g&&r&&!(r instanceof h)){const t=new h({size:10,sizeAttenuation:!1});l.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,r=t}}else{const t=new c;l.prototype.copy.call(t,r),t.color.copy(r.color),r=t}void 0===r&&(r=f?new c:g?new h({size:1,sizeAttenuation:!1}):new u,r.name=t.name,r.flatShading=!t.smooth,r.vertexColors=b,e.materials[s]=r),v.push(r)}let w;if(v.length>1){for(let t=0,e=i.length;t<e;t++){const e=i[t];y.addGroup(e.groupStart,e.groupCount,t)}w=f?new d(y,v):g?new m(y,v):new p(y,v)}else w=f?new d(y,v[0]):g?new m(y,v[0]):new p(y,v[0]);w.name=t.name,n.add(w)}else if(e.vertices.length>0){const t=new h({size:1,sizeAttenuation:!1}),s=new o;s.setAttribute("position",new a(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(s.setAttribute("color",new a(e.colors,3)),t.vertexColors=!0);const i=new m(s,t);n.add(i)}return n}}const k=new g,q=new f,O=new b,N=new b,G=new b;class R{constructor(t){this.geometry=t.geometry,this.randomFunction=Math.random,this.indexAttribute=this.geometry.index,this.positionAttribute=this.geometry.getAttribute("position"),this.normalAttribute=this.geometry.getAttribute("normal"),this.colorAttribute=this.geometry.getAttribute("color"),this.uvAttribute=this.geometry.getAttribute("uv"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(t){return this.weightAttribute=t?this.geometry.getAttribute(t):null,this}build(){const t=this.indexAttribute,e=this.positionAttribute,s=this.weightAttribute,i=t?t.count/3:e.count/3,n=new Float32Array(i);for(let a=0;a<i;a++){let i=1,r=3*a,o=3*a+1,c=3*a+2;t&&(r=t.getX(r),o=t.getX(o),c=t.getX(c)),s&&(i=s.getX(r)+s.getX(o)+s.getX(c)),k.a.fromBufferAttribute(e,r),k.b.fromBufferAttribute(e,o),k.c.fromBufferAttribute(e,c),i*=k.getArea(),n[a]=i}const r=new Float32Array(i);let o=0;for(let a=0;a<i;a++)o+=n[a],r[a]=o;return this.distribution=r,this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e,s,i){const n=this.sampleFaceIndex();return this.sampleFace(n,t,e,s,i)}sampleFaceIndex(){const t=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*t)}binarySearch(t){const e=this.distribution;let s=0,i=e.length-1,n=-1;for(;s<=i;){const r=Math.ceil((s+i)/2);if(0===r||e[r-1]<=t&&e[r]>t){n=r;break}t<e[r]?i=r-1:s=r+1}return n}sampleFace(t,e,s,i,n){let r=this.randomFunction(),o=this.randomFunction();r+o>1&&(r=1-r,o=1-o);const a=this.indexAttribute;let c=3*t,l=3*t+1,h=3*t+2;return a&&(c=a.getX(c),l=a.getX(l),h=a.getX(h)),k.a.fromBufferAttribute(this.positionAttribute,c),k.b.fromBufferAttribute(this.positionAttribute,l),k.c.fromBufferAttribute(this.positionAttribute,h),e.set(0,0,0).addScaledVector(k.a,r).addScaledVector(k.b,o).addScaledVector(k.c,1-(r+o)),void 0!==s&&(void 0!==this.normalAttribute?(k.a.fromBufferAttribute(this.normalAttribute,c),k.b.fromBufferAttribute(this.normalAttribute,l),k.c.fromBufferAttribute(this.normalAttribute,h),s.set(0,0,0).addScaledVector(k.a,r).addScaledVector(k.b,o).addScaledVector(k.c,1-(r+o)).normalize()):k.getNormal(s)),void 0!==i&&void 0!==this.colorAttribute&&(k.a.fromBufferAttribute(this.colorAttribute,c),k.b.fromBufferAttribute(this.colorAttribute,l),k.c.fromBufferAttribute(this.colorAttribute,h),q.set(0,0,0).addScaledVector(k.a,r).addScaledVector(k.b,o).addScaledVector(k.c,1-(r+o)),i.r=q.x,i.g=q.y,i.b=q.z),void 0!==n&&void 0!==this.uvAttribute&&(O.fromBufferAttribute(this.uvAttribute,c),N.fromBufferAttribute(this.uvAttribute,l),G.fromBufferAttribute(this.uvAttribute,h),n.set(0,0).addScaledVector(O,r).addScaledVector(N,o).addScaledVector(G,1-(r+o))),this}}new class{constructor(){e(this,"container"),e(this,"scene"),e(this,"camera"),e(this,"renderer"),e(this,"settings"),e(this,"particles",null),e(this,"models",{}),e(this,"currentShape","queen"),e(this,"isTransitioning",!1),e(this,"loader"),e(this,"lastTime",0);const t=document.getElementById("canvas");if(!t)throw new Error("Canvas element not found");this.container=t,this.scene=new y,this.scene.background=new n(196626),this.camera=new v(45,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,10,50),this.camera.lookAt(0,0,0),this.renderer=new w({canvas:this.container,antialias:!0,alpha:!0}),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setSize(window.innerWidth,window.innerHeight),this.settings={particleCount:15e3,particleSize:1.2,animationSpeed:1,autoRotate:!0,morphDuration:2.5,currentColor:new n(560383)},this.loader=new U,this.init()}async init(){this.setupParticles(),this.setupEvents(),this.setupUI(),await this.loadModels(),this.hideLoader(),this.morphTo("queen"),this.animate()}setupParticles(){const t=new o,e=new Float32Array(3*this.settings.particleCount);for(let i=0;i<this.settings.particleCount;i++)e[3*i]=500*(Math.random()-.5),e[3*i+1]=500*(Math.random()-.5),e[3*i+2]=500*(Math.random()-.5);t.setAttribute("position",new A(e,3));const s=new h({color:this.settings.currentColor,size:this.settings.particleSize,sizeAttenuation:!1,transparent:!0,opacity:.8,blending:x});this.particles=new m(t,s),this.scene.add(this.particles)}async loadModels(){const t=(t,e,s)=>new Promise(i=>{this.loader.load(e,e=>{let n=null;if(e.traverse(t=>{if(t.isMesh){const e=t;e.geometry.scale(s,s,s),e.geometry.center(),n=e}}),n){const e=this.samplePointsOnSurface(n,this.settings.particleCount);this.models[t]=e}i()},t=>{if(t.total>0){const e=t.loaded/t.total*100,s=document.getElementById("progress-bar");s&&(s.style.width=`${e}%`)}})});await Promise.all([t("queen","models/Queen.obj",200),t("pawn","models/Pawn.obj",250)])}samplePointsOnSurface(t,e){const s=new R(t).build(),i=new Float32Array(3*e),n=new f;for(let r=0;r<e;r++)s.sample(n),i[3*r]=n.x,i[3*r+1]=n.y,i[3*r+2]=n.z;return i}morphTo(t){if(this.isTransitioning&&"explode"!==t)return;if(!this.particles)return;this.isTransitioning=!0;const e="explode"===t?this.getExplodePositions():this.models[t];if(!e)return void(this.isTransitioning=!1);const s=this.particles.geometry.attributes.position.array;j.to(s,{duration:this.settings.morphDuration/this.settings.animationSpeed,endArray:e,ease:"expo.inOut",onUpdate:()=>{this.particles&&(this.particles.geometry.attributes.position.needsUpdate=!0)},onComplete:()=>{this.isTransitioning=!1,this.currentShape=t}}),document.querySelectorAll(".shape-btn").forEach(e=>{e.classList.toggle("active",e.dataset.shape===t)})}getExplodePositions(){const t=new Float32Array(3*this.settings.particleCount);for(let e=0;e<this.settings.particleCount;e++)t[3*e]=500*(Math.random()-.5),t[3*e+1]=500*(Math.random()-.5),t[3*e+2]=500*(Math.random()-.5);return t}setColor(t){if(!this.particles)return;const e=new n(t);j.to(this.particles.material.color,{duration:1,r:e.r,g:e.g,b:e.b,ease:"power2.out"}),this.settings.currentColor=e}setupEvents(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)});const t=document.getElementById("info-panel"),e=document.getElementById("info-toggle");t&&e&&e.addEventListener("click",()=>{t.classList.toggle("open")})}setupUI(){const t=document.getElementById("btn-queen"),e=document.getElementById("btn-pawn"),s=document.getElementById("btn-explode");t&&t.addEventListener("click",()=>this.morphTo("queen")),e&&e.addEventListener("click",()=>this.morphTo("pawn")),s&&s.addEventListener("click",()=>this.morphTo("explode"));const i=document.getElementById("speed-slider"),n=document.getElementById("speed-value");i&&i.addEventListener("input",t=>{const e=parseFloat(t.target.value);this.settings.animationSpeed=e,n&&(n.textContent=`${e.toFixed(1)}x`)});const r=document.getElementById("particle-size-slider"),o=document.getElementById("size-value");r&&r.addEventListener("input",t=>{const e=parseFloat(t.target.value);this.settings.particleSize=e,this.particles&&(this.particles.material.size=e),o&&(o.textContent=e.toFixed(1))}),document.querySelectorAll(".color-btn").forEach(t=>{t.addEventListener("click",()=>{document.querySelectorAll(".color-btn").forEach(t=>t.classList.remove("active")),t.classList.add("active");const e=t.dataset.color;e&&this.setColor(e)})});const a=document.getElementById("auto-rotate");a&&a.addEventListener("change",t=>{this.settings.autoRotate=t.target.checked});const c=document.getElementById("fullscreen-btn");c&&c.addEventListener("click",t=>{t.preventDefault(),document.fullscreenElement?(document.exitFullscreen(),t.target.textContent="Fullscreen"):(document.documentElement.requestFullscreen(),t.target.textContent="Exit Fullscreen")})}hideLoader(){const t=document.getElementById("loader");t&&(t.classList.add("hidden"),setTimeout(()=>t.style.display="none",800))}animate(){requestAnimationFrame(()=>this.animate()),this.settings.autoRotate&&this.particles&&(this.particles.rotation.y+=.005*this.settings.animationSpeed),this.updateStats(),this.renderer.render(this.scene,this.camera)}updateStats(){this.lastTime||(this.lastTime=performance.now());const t=performance.now(),e=t-this.lastTime;if(this.lastTime=t,Math.random()>.9){const t=Math.round(1e3/e),s=document.getElementById("fps-counter");s&&(s.textContent=t.toString())}}};
//# sourceMappingURL=index-DKPlbzSG.js.map
